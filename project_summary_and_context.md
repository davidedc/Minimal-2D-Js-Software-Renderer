# Project Summary and Context: Test Case Naming Convention Refinement

This document summarizes the collaborative effort to analyze existing test cases and devise a new, standardized file naming convention. It details the project's goals, data sources, the iterative evolution of the analysis table (`test_case_naming_analysis_vX.md`), and the logic applied at each stage.

## 1. Initial Goal

The primary objective was to create a file name structure for each test that captures all significant aspects of the test in a regular, orthogonal, and clear way. This involved deeply studying existing naming conventions, test file contents, and guideline documents to extract and standardize descriptive facets.

## 2. Data Sources (Including Source Code for Analysis)

The analysis was based on:

*   **Test Scripts**:
    *   Primary source code for facet value determination (especially for `StrokeThickness`, `SizeCategory`, etc.) was located in:
        1.  `/Users/davidedellacasa/code/Minimal-2D-Js-Software-Renderer/tests/browser-tests/test-cases/`
        2.  `/Users/davidedellacasa/code/Minimal-2D-Js-Software-Renderer/tests/browser-tests/performance-tests-legacy/`
    *   These directories contain the `.js` files for individual tests whose contents were analyzed to determine precise parameter ranges and behaviors.
*   **Guideline Documents**: Provided by the user to understand existing conventions and parameters, influencing initial facet extraction and some interpretations:
    *   `CONVERTING_LOW_LEVEL_TESTS.md`
    *   `adding-performance-tests.md` (and its legacy counterpart `adding-tests-to-legacy-performance-tests-setup.md`)

## 3. Evolution of the Analysis Table (`test_case_naming_analysis_vX.md`)

The core of this project was the iterative refinement of a Markdown table designed to break down each test into its constituent facets. This table evolved through several versions:

### Version 1 (Initial Table Generation - `test_case_naming_analysis.md`)

*   **User Request**: Create a Markdown table with columns: "Current Test Name", "Test Description", "Current Facets (from filename & .md)", "Suggested New Facets", and "Uncaptured Aspects".
*   **Action**: The initial table was generated by parsing filenames and extracting information from the provided `.md` guideline documents. The "Suggested New Facets" was a placeholder, and "Uncaptured Aspects" noted potential missing information.

### User Interjection: Spreadsheet Edit

*   The user indicated they had created and tweaked a spreadsheet version of this table (`test_case_naming_analysis v2.txt`, provided as a tab-separated file). This user-modified version then became the implicit basis for subsequent refinements, particularly influencing the `SizeCategory` column initially.

### Version 3 (Refining `SizeCategory` - Target: `test_case_naming_analysis_v3.md`)

*   **User Request**: Based on the (now implicit) user-edited spreadsheet, refine the `SizeCategory` column. Values should be standardized to `XS`, `S`, `M`, `L`, `XL`, `mixed`, or `N/A`, removing parenthetical comments. The user emphasized the need to examine source code to determine appropriate sizes, even for randomized values.
*   **Action**: `SizeCategory` was refined. At this stage, the capability to *directly* examine source code for each test for *this specific refinement* was not fully utilized in the execution, leading to reliance on filename cues and previous table inferences.

### Version 4 (Further `SizeCategory` Refinement - Target: `test_case_naming_analysis_v4.md`)

*   **User Request**: Clarify the use of `mixed` for `SizeCategory`. It should only be `mixed` if randomization *spans* defined buckets (XS-XL), not just if it's randomized within one. Lines should also have a size category based on length as per guideline documents.
*   **Action**: Logic was updated to better interpret filename cues for explicit size buckets (e.g., `--m-size--`) alongside randomization terms. Lines were also addressed based on filename hints for size.

### Version 5 (Corrected `SizeCategory` Logic after User Clarification - Target: `test_case_naming_analysis_v5.md`)

*   **User Correction**: User explicitly stated that the assistant *can* examine test source code, correcting a previous assumption by the assistant.
*   **User Request**: Re-address `SizeCategory` with the (now confirmed) capability to analyze file contents to determine if randomized sizes stay within a specific bucket.
*   **Action**: The `SizeCategory` column was processed again with a more robust logic, intending to simulate or perform deeper analysis based on filename and previous content analysis, aiming for more accurate XS-XL or `mixed` assignments. This step emphasized the future need to consult source code from `/tests/browser-tests/test-cases/` and `/tests/browser-tests/performance-tests-legacy/` for definitive values.

### Version 6 (Refining `FillStyle` - Target: `test_case_naming_analysis_v6.md`)

*   **User Request**: Refine the `FillStyle` column to indicate only `none`, `opaque`, `semitransparent`, or `mixed`. Remove parenthesized comments. Examine source code if needed from the test script directories.
*   **Action**: The `FillStyle` column was updated based on analysis of filenames, previous table data indicating fill properties (like color alpha from `getRandomColor` calls), and explicit mentions like `--no-fill--`. The values were standardized as requested.

### Version 7 (Refining `StrokeStyle` - Target: `test_case_naming_analysis_v7.md`)

*   **User Request**: Similar refinement for the `StrokeStyle` column, using the same possible values: `none`, `opaque`, `semitransparent`, `mixed`, `N/A`. Examine source code from test script directories if needed.
*   **Action**: `StrokeStyle` was refined by analyzing filenames for cues like `--no-stroke--`, `opaque_stroke`, `semitransparent_stroke`, and by inferring from stroke operations and color properties in the code (as simulated/analyzed previously).

### Version 8 (Refining `StrokeThickness` - First Pass - Target: `test_case_naming_analysis_v8.md`)

*   **User Request**: Standardize `StrokeThickness` to `none`, `[N]px`, `[N]px-[M]px` (for ranges), and `mixed` (for scattered or non-interval random values). Eliminate t-shirt sizing (XS-XL) from this column. Emphasized use of source code from test script directories.
*   **Action**: `StrokeThickness` was processed. Filename cues for explicit pixel values (`--1px-stroke--`) were prioritized. Other values like `mixed-px` (from previous internal states) and t-shirt sizes were intended to be converted to the new scheme. Some t-shirt sizes were missed in this pass.

### User Interjection: `v9.md` (Major Restructure, User Edits)

*   Before `v8` was correctly saved and reviewed for the `StrokeThickness` issue, the user requested a major restructuring based on their offline edits of a `v9` equivalent:
    *   Split `Positioning` into `Layout`, `CenteredAt`, `EdgeAlignment`.
    *   Merge `Orientation` and `Rotation` into a new `Orientation` column.
    *   Remove `RenderingHint`, `ParameterRandomization`, `LayoutArrangement`.
    *   The request emphasized verifying all new and existing values by referencing source code from the main test directories.
*   **Action by Assistant (leading to v9 output in chat, then v10 file)**: The assistant performed this major restructuring. The `Layout` column was initially populated. Parenthesized comments were removed. `RectAlignment` and `SceneDetails` were removed. Specific `mixed` values were set for `scene--all-shapes-combined--test.js` for several facets.

### Version 10 (`test_case_naming_analysis_v10.md` - Based on User's Edited V9)

*   **User Action**: Provided a slightly edited version of the restructured table (conceptually their `v9`).
*   **Action by Assistant**: This user-provided `v10.md` was read. Then, further refinements were made:
    *   `Layout` column was refined based on the `spread` vs. `random` distinction.
    *   All other user requests for `v10` (comment removal, column removal, scene test updates) were re-applied or confirmed.
    *   `Uncaptured Aspects` was refreshed.
    *   This was saved as `test_case_naming_analysis_v11.md` by the assistant after a versioning misstep.

### Version 11 (`test_case_naming_analysis_v11.md`)

*   This file was the result of the operations intended for `v10.md` after user clarification on versioning.
*   It contained the refined `Layout` column, removed columns (`RectAlignment`, `SceneDetails`), removed parenthetical comments, and the specific `mixed` values for the `scene--all-shapes-combined--test.js` facets.

### Version 12 (`test_case_naming_analysis_v12.md` - Correcting `StrokeThickness` Persisting Issues)

*   **User Request**: Pointed out that t-shirt sizes (L, M, XL) and an `unknown` value still persisted in the `StrokeThickness` column of the last generated file (`v11.md`).
*   **Action**: The `StrokeThickness` column in `v11.md` was re-processed. T-shirt sizes were converted to `mixed` as a placeholder if direct code analysis wasn't immediately performed or possible for those specific legacy files. The `unknown` value was also targeted for resolution, typically to `mixed` or a more specific value if derivable from filename.

### Version 13 (`test_case_naming_analysis_v13.md` - Initial `StrokeThickness` Code-Driven Refinement Attempt)
*   **User Request**: Re-evaluate `StrokeThickness` strictly to `none`, `[N]px`, `[N]px-[M]px`, or `mixed`, with ranges and specific values to be derived by reading source code from test files in `/tests/browser-tests/test-cases/` and `/tests/browser-tests/performance-tests-legacy/`. T-shirt sizes (L, M, XL) and any `unknown` values were to be replaced based on this code analysis.
*   **Action**: An attempt was made to systematically update `StrokeThickness`. Some `unknown` values were resolved to `1px` based on filename cues. T-shirt sizes were provisionally changed to `mixed` when direct file access for legacy tests failed or was pending.

### Version 14 (`test_case_naming_analysis_v14.md` - Deeper `StrokeThickness` Refinement from `test-cases` Directory)
*   **User Request**: Continue refining `StrokeThickness` by systematically analyzing the `.js` files, particularly those in `/tests/browser-tests/test-cases/` that had `mixed` values or provisional ranges.
*   **Action**: `StrokeThickness` values for several files in the `test-cases` directory were updated from `mixed` or broader ranges (e.g., `1px-11px`) to more precise `[N]px` or `[N]px-[M]px` values (e.g., `1px-10px`, `1px-11px` where applicable) based on direct code inspection of randomization logic like `SeededRandom.getRandom() * X + Y`. Some existing `mixed` values were confirmed as correct if the code showed discrete, non-continuous sets of stroke widths (e.g., only even numbers like 2, 4, 6px). Legacy files with t-shirt sizes remained `mixed` pending direct code access.

### Version 15 (`test_case_naming_analysis_v15.md` - Final `StrokeThickness` Refinement with Legacy File Analysis)
*   **User Request**: Complete the `StrokeThickness` refinement by analyzing the provided source code for the legacy test files (from `/tests/browser-tests/performance-tests-legacy/`) that still had `mixed` values derived from previous t-shirt size conversions.
*   **Action**: The `StrokeThickness` for the four specified legacy test files (`lines--M-size--no-fill--L-opaque-stroke...`, `rectangles--M-size--opaque_fill--M-opaque_stroke...`, `circles--M-size--opaque_fill--M-opaque_stroke...`, `circles--XL-size--opaque_fill--XL-opaque_stroke...`) were updated from `mixed` to specific `[N]px-[M]px` ranges (e.g., `1px-5px`, `10px-20px`) based on direct analysis of their JavaScript source code. This version represents the most accurate `StrokeThickness` column based on all available information and code.

## 4. Current State (Leading to `test_case_naming_analysis_v15.md`)

The table `test_case_naming_analysis_v15.md` represents the most current, detailed breakdown of test facets. It has undergone several passes of refinement for columns like `SizeCategory`, `FillStyle`, `StrokeStyle`, and most recently, an intensive, code-driven refinement of `StrokeThickness`. It also includes a major restructuring (Layout, CenteredAt, EdgeAlignment, revised Orientation). All parenthetical comments have been removed, and specific columns have been dropped. The facet values, particularly for `StrokeThickness`, are now directly informed by analysis of the JavaScript test files in `/Users/davidedellacasa/code/Minimal-2D-Js-Software-Renderer/tests/browser-tests/test-cases/` and `/Users/davidedellacasa/code/Minimal-2D-Js-Software-Renderer/tests/browser-tests/performance-tests-legacy/`.

## 5. Purpose of this Document (`project_summary_and_context.md`)

This document serves as a comprehensive log of the project's progression, the rationale behind changes to the analysis table, and the detailed criteria applied to each facet. It aims to provide clarity on how `test_case_naming_analysis_v15.md` was derived, facilitating the final steps of defining canonical facet values and establishing the new file naming convention.

## 6. Next Steps (Following `v15.md`)

The immediate next steps involve:
1.  Thorough review of `test_case_naming_analysis_v15.md` by the user.
2.  Defining the canonical (standardized) set of allowed string values for each facet that will be part of the new filenames.
3.  Defining the exact structure of the new filenames: which facets to include, their order, and separators.
4.  Planning and executing the renaming of the test files based on the new convention. 